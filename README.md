# dotfiles

<div align="center">
   <a href="#--------">
      <img src="assets/current-look.png" alt="Desktop Screenshot">
   </a>
</div>

### Setup & Applications:

- **OS:** [EndeavourOS](https://endeavouros.com/)
- **WM:** [bspwm](https://github.com/baskerville/bspwm)
- **Widgets/Bar:** [Eww](https://github.com/elkowar/eww)
- **Terminal:** [alacritty](https://github.com/alacritty/alacritty)
- **Shell:** [zsh](https://www.zsh.org/)
- **Editor:** [vscode](https://github.com/microsoft/vscode)
- **Compositor:** [picom](https://github.com/jonaburg/picom)
- **Application Launcher:** [rofi](https://github.com/davatorium/rofi)

### Tips For Getting Eww Widgets to Work:
1. The widgets were designed to work with bspwm workspaces. Make sure to define the workspace numbers within `scripts/workspace-primary` to reflect what is configured in `bspwmrc`. If using multiple monitors, also define workspaces assigned to the second monitor in `scripts/workspace-secondary`.

2. If you aren't using an ASUS Zenbook Duo, remove the screenpad slider from the control center (see comments at the top of `widgets/control-center.yuck`). 

3. Many of the scripts require specific paths which may differ from system-to-system so test each script to determine where changes need to be made. For example, the location of the file which holds the state of the current keyboard brightness in `scripts/keyboard-brightness` and `scripts/initializer` is likely different if you aren't on ASUS hardware.

4. Colors are imported into `eww.scss` from `~/.cache/wal/colors.scss` which is generated by pywal. This causes the widgets to adapt to generated colorschemes on the fly. Just make sure to edit the directory path at the top of `eww.scss` and `widgets/control-center.scss`.

5. Add your weather Key/ID from [Open Weather Map](openweathermap.org/) to `scripts/weather`.
---
### Additional Notes Regarding Control Center Widget:

Unlike most eww configurations, I've tried to eliminate many polling variables which rely on busy loops. The following variables in this configuration would typically utilize defpoll variables with busy loops:
- airplane-status
- airplane-icon
- dnd-status
- dnd-color
- keybright-image
- weather-color (updated when weather-temp updates)
- weather-icon (updates when weather-temp updates)

Normally, variables such as these are designed to execute scripts every X seconds (often 1s) in order to keep variables up-to-date with state changes. This has the benefit of keeping the state of variables highly accurate at the cost of wasting CPU cycles and introducing laggy/sluggish behavior in widgets. Additionally, many of these variables rarely change such as with a variable containing the status of whether airplane mode is enabled or disabled so polling for them is often unnecessary. 

Therefore, these variables have been changed to ordinary defvar variables within my configurations. State changes made **through Eww** will cause scripts to execute which will update these variables via the `eww update` command. This wastes less CPU cycles and causes changes within widgets to be reflected quicker. However, this can cause the state of variables to be inaccurate if state changes occur outside of Eww. For example, changing the keyboard brightness via keyboard keys (instead of through the widget) will cause the keyboard brightness image in the widget to reflect an incorrect state (see below for fixes).

A second issue with not using polling variables is that Eww does not allow ordinary variables to be intiialized dynamically (i.e., from a script). To get around this, a script called `initializer` runs when Eww is started in order to dynamically initialize variables to the proper states. In order to get this script to run within Eww it needs to be used within a widget (otherwise it is disregarded and not executed). Therefore, it is used within an empty text label located in the hover area for the Control Center.

### Options If You'd Rather Use Polling Variables:

Easiest Fix: The initializer script can be set to run frequently in order to correct state changes that occur outside of Eww but I find this largely unnecessary.

Normie Way: Traditional scripts which work with defpoll variables are included in the `deprecated` folder. 

---

Credits to [rxyhn](https://github.com/rxyhn) for base Eww widgets and scripts

